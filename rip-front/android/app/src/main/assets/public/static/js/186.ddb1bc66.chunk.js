"use strict";(self.webpackChunkrip_front=self.webpackChunkrip_front||[]).push([[186],{1186:function(e,t,n){n.r(t),n.d(t,{startInputShims:function(){return E}});var r=n(4165),o=n(5861),i=n(9344),a=n(1811),u=new WeakMap,c=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];u.has(e)!==n&&(n?d(e,t,r,o):l(e,t))},s=function(e){return e===e.getRootNode().activeElement},d=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.parentNode,i=t.cloneNode(!1);i.classList.add("cloned-input"),i.tabIndex=-1,r&&(i.disabled=!0),o.appendChild(i),u.set(e,i);var a=e.ownerDocument,c="rtl"===a.dir?9999:-9999;e.style.pointerEvents="none",t.style.transform="translate3d(".concat(c,"px,").concat(n,"px,0) scale(0)")},l=function(e,t){var n=u.get(e);n&&(u.delete(e),n.remove()),e.style.pointerEvents="",t.style.transform=""},f=function(e,t,n){if(!n||!t)return function(){};var r=function(n){s(t)&&c(e,t,n)},o=function(){return c(e,t,!1)},i=function(){return r(!0)},u=function(){return r(!1)};return(0,a.a)(n,"ionScrollStart",i),(0,a.a)(n,"ionScrollEnd",u),t.addEventListener("blur",o),function(){(0,a.b)(n,"ionScrollStart",i),(0,a.b)(n,"ionScrollEnd",u),t.addEventListener("ionBlur",o)}},v="input, textarea, [no-blur], [contenteditable]",p=function(e,t,n){var r,o=null!==(r=e.closest("ion-item,[ion-item]"))&&void 0!==r?r:e;return m(o.getBoundingClientRect(),t.getBoundingClientRect(),n,e.ownerDocument.defaultView.innerHeight)},m=function(e,t,n,r){var o=e.top,i=e.bottom,a=t.top,u=a+15,c=.75*Math.min(t.bottom,r-n)-i,s=u-o,d=Math.round(c<0?-c:s>0?-s:0),l=Math.min(d,o-a),f=Math.abs(l)/.3;return{scrollAmount:l,scrollDuration:Math.min(400,Math.max(150,f)),scrollPadding:n,inputSafeY:4-(o-u)}},h=function(e,t,n,r,o){var i,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=function(e){i=(0,a.p)(e)},d=function(c){if(i){var d=(0,a.p)(c);b(6,i,d)||s(t)||w(e,t,n,r,o,u)}};return e.addEventListener("touchstart",c,{capture:!0,passive:!0}),e.addEventListener("touchend",d,!0),function(){e.removeEventListener("touchstart",c,!0),e.removeEventListener("touchend",d,!0)}},w=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n,u,s,d){var l,f,v,m,h,w,b,g=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=g.length>5&&void 0!==g[5]&&g[5],u||s){e.next=3;break}return e.abrupt("return");case 3:if(f=p(t,u||s,d),!(u&&Math.abs(f.scrollAmount)<4)){e.next=7;break}return n.focus(),e.abrupt("return");case 7:if(c(t,n,!0,f.inputSafeY,l),n.focus(),(0,a.r)((function(){return t.click()})),"undefined"===typeof window){e.next=23;break}if(m=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==v&&clearTimeout(v),window.removeEventListener("ionKeyboardDidShow",h),window.removeEventListener("ionKeyboardDidShow",m),!u){e.next=6;break}return e.next=6,(0,i.c)(u,0,f.scrollAmount,f.scrollDuration);case 6:c(t,n,!1,f.inputSafeY),n.focus();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function e(){window.removeEventListener("ionKeyboardDidShow",e),window.addEventListener("ionKeyboardDidShow",m)},!u){e.next=22;break}return e.next=16,(0,i.g)(u);case 16:if(w=e.sent,b=w.scrollHeight-w.clientHeight,!(f.scrollAmount>b-w.scrollTop)){e.next=22;break}return"password"===n.type?(f.scrollAmount+=50,window.addEventListener("ionKeyboardDidShow",h)):window.addEventListener("ionKeyboardDidShow",m),v=setTimeout(m,1e3),e.abrupt("return");case 22:m();case 23:case"end":return e.stop()}}),e)})));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),b=function(e,t,n){if(t&&n){var r=t.x-n.x,o=t.y-n.y;return r*r+o*o>e*e}return!1},g="$ionPaddingTimer",y=function(e,t){var n,r;if("INPUT"===e.tagName&&(!e.parentElement||"ION-INPUT"!==e.parentElement.tagName)&&"ION-SEARCHBAR"!==(null===(r=null===(n=e.parentElement)||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.tagName)){var o=(0,i.a)(e);if(null!==o){var a=o[g];a&&clearTimeout(a),t>0?o.style.setProperty("--keyboard-offset","".concat(t,"px")):o[g]=setTimeout((function(){o.style.setProperty("--keyboard-offset","0px")}),120)}}},E=function(e,t){var n=document,u="ios"===t,c="android"===t,s=e.getNumber("keyboardHeight",290),d=e.getBoolean("scrollAssist",!0),l=e.getBoolean("hideCaretOnScroll",u),p=e.getBoolean("inputBlurring",u),m=e.getBoolean("scrollPadding",!0),w=Array.from(n.querySelectorAll("ion-input, ion-textarea")),b=new WeakMap,g=new WeakMap,E=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,o,u,v,p,m;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return(0,a.c)(t,e)}));case 2:if(n=t.shadowRoot||t,o=n.querySelector("input")||n.querySelector("textarea"),u=(0,i.a)(t),v=u?null:t.closest("ion-footer"),o){e.next=8;break}return e.abrupt("return");case 8:u&&l&&!b.has(t)&&(p=f(t,o,u),b.set(t,p)),"date"===o.type||"datetime-local"===o.type||!u&&!v||!d||g.has(t)||(m=h(t,o,u,v,s,c),g.set(t,m));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();p&&function(){var e=!0,t=!1,n=document,r=function(){t=!0},o=function(){e=!0},i=function(r){if(t)t=!1;else{var o=n.activeElement;if(o&&!o.matches(v)){var i=r.target;i!==o&&(i.matches(v)||i.closest(v)||(e=!1,setTimeout((function(){e||o.blur()}),50)))}}};(0,a.a)(n,"ionScrollStart",r),n.addEventListener("focusin",o,!0),n.addEventListener("touchend",i,!1)}(),m&&function(e){var t=document,n=function(t){y(t.target,e)},r=function(e){y(e.target,0)};t.addEventListener("focusin",n),t.addEventListener("focusout",r)}(s);for(var x=0,S=w;x<S.length;x++){var k=S[x];E(k)}n.addEventListener("ionInputDidLoad",(function(e){E(e.detail)})),n.addEventListener("ionInputDidUnload",(function(e){!function(e){if(l){var t=b.get(e);t&&t(),b.delete(e)}if(d){var n=g.get(e);n&&n(),g.delete(e)}}(e.detail)}))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxLQWZILENBUkEsQ0F3QkYsR0FDQWxILEVBQUFBLEVBQUFBLEdBQWlCbEIsRUFBSyxpQkFBa0I2SCxHQUN4QzdILEVBQUlrQixpQkFBaUIsVUFBVzRHLEdBQVcsR0FDM0M5SCxFQUFJa0IsaUJBQWlCLFdBQVk2RyxHQUFZLEVBTS9DLENBNlFJTSxHQUVFbEYsR0E5R3NCLFNBQUM1QixHQUMzQixJQUFNdkIsRUFBTXNHLFNBQ053QixFQUFZLFNBQUNwRSxHQUNqQmlDLEVBQWlCakMsRUFBR3lFLE9BQVE1RyxFQUM5QixFQUNNK0csRUFBYSxTQUFDNUUsR0FDbEJpQyxFQUFpQmpDLEVBQUd5RSxPQUFRLEVBQzlCLEVBQ0FuSSxFQUFJa0IsaUJBQWlCLFVBQVc0RyxHQUNoQzlILEVBQUlrQixpQkFBaUIsV0FBWW9ILEVBS25DLENBaUdJQyxDQUFvQmhILEdBS3RCLElBQUssSUFBTCxNQUFvQnNGLEVBQU0sZUFBRSxDQUF2QixJQUFNMUgsRUFBSyxLQUNkZ0ksRUFBY2hJLEVBQ2hCLENBQ0FhLEVBQUlrQixpQkFBaUIsbUJBQW9CLFNBQUN3QyxHQUN4Q3lELEVBQWN6RCxFQUFHOEUsT0FDbkIsSUFDQXhJLEVBQUlrQixpQkFBaUIscUJBQXNCLFNBQUN3QyxJQS9CcEIsU0FBQ2hGLEdBQ3ZCLEdBQUlzQyxFQUFXLENBQ2IsSUFBTXlILEVBQUt4QixFQUFhekcsSUFBSTlCLEdBQ3hCK0osR0FDRkEsSUFFRnhCLEVBQWF4RyxPQUFPL0IsRUFDdEIsQ0FDQSxHQUFJZ0ksRUFBYyxDQUNoQixJQUFNK0IsRUFBS3ZCLEVBQWdCMUcsSUFBSTlCLEdBQzNCK0osR0FDRkEsSUFFRnZCLEVBQWdCekcsT0FBTy9CLEVBQ3pCLENBQ0YsQ0FpQkVnSyxDQUFnQmhGLEVBQUc4RSxPQUNyQixHQUNGLEMiLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9AaW9uaWMvY29yZS9jb21wb25lbnRzL2lucHV0LXNoaW1zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogKEMpIElvbmljIGh0dHA6Ly9pb25pY2ZyYW1ld29yay5jb20gLSBNSVQgTGljZW5zZVxuICovXG5pbXBvcnQgeyBnIGFzIGdldFNjcm9sbEVsZW1lbnQsIGMgYXMgc2Nyb2xsQnlQb2ludCwgYSBhcyBmaW5kQ2xvc2VzdElvbkNvbnRlbnQgfSBmcm9tICcuL2luZGV4OS5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEV2ZW50TGlzdGVuZXIsIGIgYXMgcmVtb3ZlRXZlbnRMaXN0ZW5lciwgciBhcyByYWYsIHAgYXMgcG9pbnRlckNvb3JkLCBjIGFzIGNvbXBvbmVudE9uUmVhZHkgfSBmcm9tICcuL2hlbHBlcnMuanMnO1xuXG5jb25zdCBjbG9uZU1hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCByZWxvY2F0ZUlucHV0ID0gKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBzaG91bGRSZWxvY2F0ZSwgaW5wdXRSZWxhdGl2ZVkgPSAwLCBkaXNhYmxlZENsb25lZElucHV0ID0gZmFsc2UpID0+IHtcbiAgaWYgKGNsb25lTWFwLmhhcyhjb21wb25lbnRFbCkgPT09IHNob3VsZFJlbG9jYXRlKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChzaG91bGRSZWxvY2F0ZSkge1xuICAgIGFkZENsb25lKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBpbnB1dFJlbGF0aXZlWSwgZGlzYWJsZWRDbG9uZWRJbnB1dCk7XG4gIH1cbiAgZWxzZSB7XG4gICAgcmVtb3ZlQ2xvbmUoY29tcG9uZW50RWwsIGlucHV0RWwpO1xuICB9XG59O1xuY29uc3QgaXNGb2N1c2VkID0gKGlucHV0KSA9PiB7XG4gIHJldHVybiBpbnB1dCA9PT0gaW5wdXQuZ2V0Um9vdE5vZGUoKS5hY3RpdmVFbGVtZW50O1xufTtcbmNvbnN0IGFkZENsb25lID0gKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBpbnB1dFJlbGF0aXZlWSwgZGlzYWJsZWRDbG9uZWRJbnB1dCA9IGZhbHNlKSA9PiB7XG4gIC8vIHRoaXMgYWxsb3dzIGZvciB0aGUgYWN0dWFsIGlucHV0IHRvIHJlY2VpdmUgdGhlIGZvY3VzIGZyb21cbiAgLy8gdGhlIHVzZXIncyB0b3VjaCBldmVudCwgYnV0IGJlZm9yZSBpdCByZWNlaXZlcyBmb2N1cywgaXRcbiAgLy8gbW92ZXMgdGhlIGFjdHVhbCBpbnB1dCB0byBhIGxvY2F0aW9uIHRoYXQgd2lsbCBub3Qgc2NyZXdcbiAgLy8gdXAgdGhlIGFwcCdzIGxheW91dCwgYW5kIGRvZXMgbm90IGFsbG93IHRoZSBuYXRpdmUgYnJvd3NlclxuICAvLyB0byBhdHRlbXB0IHRvIHNjcm9sbCB0aGUgaW5wdXQgaW50byBwbGFjZSAobWVzc2luZyB1cCBoZWFkZXJzL2Zvb3RlcnMpXG4gIC8vIHRoZSBjbG9uZWQgaW5wdXQgZmlsbHMgdGhlIGFyZWEgb2Ygd2hlcmUgbmF0aXZlIGlucHV0IHNob3VsZCBiZVxuICAvLyB3aGlsZSB0aGUgbmF0aXZlIGlucHV0IGZha2VzIG91dCB0aGUgYnJvd3NlciBieSByZWxvY2F0aW5nIGl0c2VsZlxuICAvLyBiZWZvcmUgaXQgcmVjZWl2ZXMgdGhlIGFjdHVhbCBmb2N1cyBldmVudFxuICAvLyBXZSBoaWRlIHRoZSBmb2N1c2VkIGlucHV0ICh3aXRoIHRoZSB2aXNpYmxlIGNhcmV0KSBpbnZpc2libGUgYnkgbWFraW5nIGl0IHNjYWxlKDApLFxuICBjb25zdCBwYXJlbnRFbCA9IGlucHV0RWwucGFyZW50Tm9kZTtcbiAgLy8gRE9NIFdSSVRFU1xuICBjb25zdCBjbG9uZWRFbCA9IGlucHV0RWwuY2xvbmVOb2RlKGZhbHNlKTtcbiAgY2xvbmVkRWwuY2xhc3NMaXN0LmFkZCgnY2xvbmVkLWlucHV0Jyk7XG4gIGNsb25lZEVsLnRhYkluZGV4ID0gLTE7XG4gIC8qKlxuICAgKiBNYWtpbmcgdGhlIGNsb25lZCBpbnB1dCBkaXNhYmxlZCBwcmV2ZW50c1xuICAgKiBDaHJvbWUgZm9yIEFuZHJvaWQgZnJvbSBzdGlsbCBzY3JvbGxpbmdcbiAgICogdGhlIGVudGlyZSBwYWdlIHNpbmNlIHRoaXMgY2xvbmVkIGlucHV0XG4gICAqIHdpbGwgYnJpZWZseSBiZSBoaWRkZW4gYnkgdGhlIGtleWJvYXJkXG4gICAqIGV2ZW4gdGhvdWdoIGl0IGlzIG5vdCBmb2N1c2VkLlxuICAgKlxuICAgKiBUaGlzIGlzIG5vdCBuZWVkZWQgb24gaU9TLiBXaGlsZSB0aGlzXG4gICAqIGRvZXMgbm90IGNhdXNlIGZ1bmN0aW9uYWwgaXNzdWVzIG9uIGlPUyxcbiAgICogdGhlIGlucHV0IHN0aWxsIGFwcGVhcnMgc2xpZ2h0bHkgZGltbWVkIGV2ZW5cbiAgICogaWYgd2Ugc2V0IG9wYWNpdHk6IDEuXG4gICAqL1xuICBpZiAoZGlzYWJsZWRDbG9uZWRJbnB1dCkge1xuICAgIGNsb25lZEVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuICBwYXJlbnRFbC5hcHBlbmRDaGlsZChjbG9uZWRFbCk7XG4gIGNsb25lTWFwLnNldChjb21wb25lbnRFbCwgY2xvbmVkRWwpO1xuICBjb25zdCBkb2MgPSBjb21wb25lbnRFbC5vd25lckRvY3VtZW50O1xuICBjb25zdCB0eCA9IGRvYy5kaXIgPT09ICdydGwnID8gOTk5OSA6IC05OTk5O1xuICBjb21wb25lbnRFbC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xuICBpbnB1dEVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUzZCgke3R4fXB4LCR7aW5wdXRSZWxhdGl2ZVl9cHgsMCkgc2NhbGUoMClgO1xufTtcbmNvbnN0IHJlbW92ZUNsb25lID0gKGNvbXBvbmVudEVsLCBpbnB1dEVsKSA9PiB7XG4gIGNvbnN0IGNsb25lID0gY2xvbmVNYXAuZ2V0KGNvbXBvbmVudEVsKTtcbiAgaWYgKGNsb25lKSB7XG4gICAgY2xvbmVNYXAuZGVsZXRlKGNvbXBvbmVudEVsKTtcbiAgICBjbG9uZS5yZW1vdmUoKTtcbiAgfVxuICBjb21wb25lbnRFbC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJyc7XG4gIGlucHV0RWwuc3R5bGUudHJhbnNmb3JtID0gJyc7XG59O1xuXG5jb25zdCBlbmFibGVIaWRlQ2FyZXRPblNjcm9sbCA9IChjb21wb25lbnRFbCwgaW5wdXRFbCwgc2Nyb2xsRWwpID0+IHtcbiAgaWYgKCFzY3JvbGxFbCB8fCAhaW5wdXRFbCkge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICByZXR1cm47XG4gICAgfTtcbiAgfVxuICBjb25zdCBzY3JvbGxIaWRlQ2FyZXQgPSAoc2hvdWxkSGlkZUNhcmV0KSA9PiB7XG4gICAgaWYgKGlzRm9jdXNlZChpbnB1dEVsKSkge1xuICAgICAgcmVsb2NhdGVJbnB1dChjb21wb25lbnRFbCwgaW5wdXRFbCwgc2hvdWxkSGlkZUNhcmV0KTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IG9uQmx1ciA9ICgpID0+IHJlbG9jYXRlSW5wdXQoY29tcG9uZW50RWwsIGlucHV0RWwsIGZhbHNlKTtcbiAgY29uc3QgaGlkZUNhcmV0ID0gKCkgPT4gc2Nyb2xsSGlkZUNhcmV0KHRydWUpO1xuICBjb25zdCBzaG93Q2FyZXQgPSAoKSA9PiBzY3JvbGxIaWRlQ2FyZXQoZmFsc2UpO1xuICBhZGRFdmVudExpc3RlbmVyKHNjcm9sbEVsLCAnaW9uU2Nyb2xsU3RhcnQnLCBoaWRlQ2FyZXQpO1xuICBhZGRFdmVudExpc3RlbmVyKHNjcm9sbEVsLCAnaW9uU2Nyb2xsRW5kJywgc2hvd0NhcmV0KTtcbiAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25CbHVyKTtcbiAgcmV0dXJuICgpID0+IHtcbiAgICByZW1vdmVFdmVudExpc3RlbmVyKHNjcm9sbEVsLCAnaW9uU2Nyb2xsU3RhcnQnLCBoaWRlQ2FyZXQpO1xuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc2Nyb2xsRWwsICdpb25TY3JvbGxFbmQnLCBzaG93Q2FyZXQpO1xuICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW9uQmx1cicsIG9uQmx1cik7XG4gIH07XG59O1xuXG5jb25zdCBTS0lQX1NFTEVDVE9SID0gJ2lucHV0LCB0ZXh0YXJlYSwgW25vLWJsdXJdLCBbY29udGVudGVkaXRhYmxlXSc7XG5jb25zdCBlbmFibGVJbnB1dEJsdXJyaW5nID0gKCkgPT4ge1xuICBsZXQgZm9jdXNlZCA9IHRydWU7XG4gIGxldCBkaWRTY3JvbGwgPSBmYWxzZTtcbiAgY29uc3QgZG9jID0gZG9jdW1lbnQ7XG4gIGNvbnN0IG9uU2Nyb2xsID0gKCkgPT4ge1xuICAgIGRpZFNjcm9sbCA9IHRydWU7XG4gIH07XG4gIGNvbnN0IG9uRm9jdXNpbiA9ICgpID0+IHtcbiAgICBmb2N1c2VkID0gdHJ1ZTtcbiAgfTtcbiAgY29uc3Qgb25Ub3VjaGVuZCA9IChldikgPT4ge1xuICAgIC8vIGlmIGFwcCBkaWQgc2Nyb2xsIHJldHVybiBlYXJseVxuICAgIGlmIChkaWRTY3JvbGwpIHtcbiAgICAgIGRpZFNjcm9sbCA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBhY3RpdmUgPSBkb2MuYWN0aXZlRWxlbWVudDtcbiAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBvbmx5IGJsdXIgaWYgdGhlIGFjdGl2ZSBlbGVtZW50IGlzIGEgdGV4dC1pbnB1dCBvciBhIHRleHRhcmVhXG4gICAgaWYgKGFjdGl2ZS5tYXRjaGVzKFNLSVBfU0VMRUNUT1IpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIGlmIHRoZSBzZWxlY3RlZCB0YXJnZXQgaXMgdGhlIGFjdGl2ZSBlbGVtZW50LCBkbyBub3QgYmx1clxuICAgIGNvbnN0IHRhcHBlZCA9IGV2LnRhcmdldDtcbiAgICBpZiAodGFwcGVkID09PSBhY3RpdmUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRhcHBlZC5tYXRjaGVzKFNLSVBfU0VMRUNUT1IpIHx8IHRhcHBlZC5jbG9zZXN0KFNLSVBfU0VMRUNUT1IpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvY3VzZWQgPSBmYWxzZTtcbiAgICAvLyBUT0RPIEZXLTI3OTY6IGZpbmQgYSBiZXR0ZXIgd2F5LCB3aHkgNTBtcz9cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICghZm9jdXNlZCkge1xuICAgICAgICBhY3RpdmUuYmx1cigpO1xuICAgICAgfVxuICAgIH0sIDUwKTtcbiAgfTtcbiAgYWRkRXZlbnRMaXN0ZW5lcihkb2MsICdpb25TY3JvbGxTdGFydCcsIG9uU2Nyb2xsKTtcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvbkZvY3VzaW4sIHRydWUpO1xuICBkb2MuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBvblRvdWNoZW5kLCBmYWxzZSk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihkb2MsICdpb25TY3JvbGxTdGFydCcsIG9uU2Nyb2xsLCB0cnVlKTtcbiAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIG9uRm9jdXNpbiwgdHJ1ZSk7XG4gICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Ub3VjaGVuZCwgZmFsc2UpO1xuICB9O1xufTtcblxuY29uc3QgU0NST0xMX0FTU0lTVF9TUEVFRCA9IDAuMztcbmNvbnN0IGdldFNjcm9sbERhdGEgPSAoY29tcG9uZW50RWwsIGNvbnRlbnRFbCwga2V5Ym9hcmRIZWlnaHQpID0+IHtcbiAgdmFyIF9hO1xuICBjb25zdCBpdGVtRWwgPSAoX2EgPSBjb21wb25lbnRFbC5jbG9zZXN0KCdpb24taXRlbSxbaW9uLWl0ZW1dJykpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGNvbXBvbmVudEVsO1xuICByZXR1cm4gY2FsY1Njcm9sbERhdGEoaXRlbUVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBjb250ZW50RWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIGtleWJvYXJkSGVpZ2h0LCBjb21wb25lbnRFbC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmlubmVySGVpZ2h0KTtcbn07XG5jb25zdCBjYWxjU2Nyb2xsRGF0YSA9IChpbnB1dFJlY3QsIGNvbnRlbnRSZWN0LCBrZXlib2FyZEhlaWdodCwgcGxhdGZvcm1IZWlnaHQpID0+IHtcbiAgLy8gY29tcHV0ZSBpbnB1dCdzIFkgdmFsdWVzIHJlbGF0aXZlIHRvIHRoZSBib2R5XG4gIGNvbnN0IGlucHV0VG9wID0gaW5wdXRSZWN0LnRvcDtcbiAgY29uc3QgaW5wdXRCb3R0b20gPSBpbnB1dFJlY3QuYm90dG9tO1xuICAvLyBjb21wdXRlIHZpc2libGUgYXJlYVxuICBjb25zdCB2aXNpYmxlQXJlYVRvcCA9IGNvbnRlbnRSZWN0LnRvcDtcbiAgY29uc3QgdmlzaWJsZUFyZWFCb3R0b20gPSBNYXRoLm1pbihjb250ZW50UmVjdC5ib3R0b20sIHBsYXRmb3JtSGVpZ2h0IC0ga2V5Ym9hcmRIZWlnaHQpO1xuICAvLyBjb21wdXRlIHNhZmUgYXJlYVxuICBjb25zdCBzYWZlQXJlYVRvcCA9IHZpc2libGVBcmVhVG9wICsgMTU7XG4gIGNvbnN0IHNhZmVBcmVhQm90dG9tID0gdmlzaWJsZUFyZWFCb3R0b20gKiAwLjc1O1xuICAvLyBmaWd1cmUgb3V0IGlmIGVhY2ggZWRnZSBvZiB0aGUgaW5wdXQgaXMgd2l0aGluIHRoZSBzYWZlIGFyZWFcbiAgY29uc3QgZGlzdGFuY2VUb0JvdHRvbSA9IHNhZmVBcmVhQm90dG9tIC0gaW5wdXRCb3R0b207XG4gIGNvbnN0IGRpc3RhbmNlVG9Ub3AgPSBzYWZlQXJlYVRvcCAtIGlucHV0VG9wO1xuICAvLyBkZXNpcmVkU2Nyb2xsQW1vdW50IGlzIHRoZSBuZWdhdGVkIGRpc3RhbmNlIHRvIHRoZSBzYWZlIGFyZWEgYWNjb3JkaW5nIHRvIG91ciBjYWxjdWxhdGlvbnMuXG4gIGNvbnN0IGRlc2lyZWRTY3JvbGxBbW91bnQgPSBNYXRoLnJvdW5kKGRpc3RhbmNlVG9Cb3R0b20gPCAwID8gLWRpc3RhbmNlVG9Cb3R0b20gOiBkaXN0YW5jZVRvVG9wID4gMCA/IC1kaXN0YW5jZVRvVG9wIDogMCk7XG4gIC8vIG91ciBjYWxjdWxhdGlvbnMgbWFrZSBzb21lIGFzc3VtcHRpb25zIHRoYXQgYXJlbid0IGFsd2F5cyB0cnVlLCBsaWtlIHRoZSBrZXlib2FyZCBiZWluZyBjbG9zZWQgd2hlbiBhbiBpbnB1dFxuICAvLyBnZXRzIGZvY3VzLCBzbyBtYWtlIHN1cmUgd2UgZG9uJ3Qgc2Nyb2xsIHRoZSBpbnB1dCBhYm92ZSB0aGUgdmlzaWJsZSBhcmVhXG4gIGNvbnN0IHNjcm9sbEFtb3VudCA9IE1hdGgubWluKGRlc2lyZWRTY3JvbGxBbW91bnQsIGlucHV0VG9wIC0gdmlzaWJsZUFyZWFUb3ApO1xuICBjb25zdCBkaXN0YW5jZSA9IE1hdGguYWJzKHNjcm9sbEFtb3VudCk7XG4gIGNvbnN0IGR1cmF0aW9uID0gZGlzdGFuY2UgLyBTQ1JPTExfQVNTSVNUX1NQRUVEO1xuICBjb25zdCBzY3JvbGxEdXJhdGlvbiA9IE1hdGgubWluKDQwMCwgTWF0aC5tYXgoMTUwLCBkdXJhdGlvbikpO1xuICByZXR1cm4ge1xuICAgIHNjcm9sbEFtb3VudCxcbiAgICBzY3JvbGxEdXJhdGlvbixcbiAgICBzY3JvbGxQYWRkaW5nOiBrZXlib2FyZEhlaWdodCxcbiAgICBpbnB1dFNhZmVZOiAtKGlucHV0VG9wIC0gc2FmZUFyZWFUb3ApICsgNCxcbiAgfTtcbn07XG5cbmNvbnN0IGVuYWJsZVNjcm9sbEFzc2lzdCA9IChjb21wb25lbnRFbCwgaW5wdXRFbCwgY29udGVudEVsLCBmb290ZXJFbCwga2V5Ym9hcmRIZWlnaHQsIGRpc2FibGVDbG9uZWRJbnB1dCA9IGZhbHNlKSA9PiB7XG4gIGxldCBjb29yZDtcbiAgY29uc3QgdG91Y2hTdGFydCA9IChldikgPT4ge1xuICAgIGNvb3JkID0gcG9pbnRlckNvb3JkKGV2KTtcbiAgfTtcbiAgY29uc3QgdG91Y2hFbmQgPSAoZXYpID0+IHtcbiAgICAvLyBpbnB1dCBjb3ZlciB0b3VjaGVuZC9tb3VzZXVwXG4gICAgaWYgKCFjb29yZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBnZXQgd2hlcmUgdGhlIHRvdWNoZW5kL21vdXNldXAgZW5kZWRcbiAgICBjb25zdCBlbmRDb29yZCA9IHBvaW50ZXJDb29yZChldik7XG4gICAgLy8gZm9jdXMgdGhpcyBpbnB1dCBpZiB0aGUgcG9pbnRlciBoYXNuJ3QgbW92ZWQgWFggcGl4ZWxzXG4gICAgLy8gYW5kIHRoZSBpbnB1dCBkb2Vzbid0IGFscmVhZHkgaGF2ZSBmb2N1c1xuICAgIGlmICghaGFzUG9pbnRlck1vdmVkKDYsIGNvb3JkLCBlbmRDb29yZCkgJiYgIWlzRm9jdXNlZChpbnB1dEVsKSkge1xuICAgICAgLy8gYmVnaW4gdGhlIGlucHV0IGZvY3VzIHByb2Nlc3NcbiAgICAgIGpzU2V0Rm9jdXMoY29tcG9uZW50RWwsIGlucHV0RWwsIGNvbnRlbnRFbCwgZm9vdGVyRWwsIGtleWJvYXJkSGVpZ2h0LCBkaXNhYmxlQ2xvbmVkSW5wdXQpO1xuICAgIH1cbiAgfTtcbiAgY29tcG9uZW50RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRvdWNoU3RhcnQsIHsgY2FwdHVyZTogdHJ1ZSwgcGFzc2l2ZTogdHJ1ZSB9KTtcbiAgY29tcG9uZW50RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0b3VjaEVuZCwgdHJ1ZSk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgY29tcG9uZW50RWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRvdWNoU3RhcnQsIHRydWUpO1xuICAgIGNvbXBvbmVudEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdG91Y2hFbmQsIHRydWUpO1xuICB9O1xufTtcbmNvbnN0IGpzU2V0Rm9jdXMgPSBhc3luYyAoY29tcG9uZW50RWwsIGlucHV0RWwsIGNvbnRlbnRFbCwgZm9vdGVyRWwsIGtleWJvYXJkSGVpZ2h0LCBkaXNhYmxlQ2xvbmVkSW5wdXQgPSBmYWxzZSkgPT4ge1xuICBpZiAoIWNvbnRlbnRFbCAmJiAhZm9vdGVyRWwpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qgc2Nyb2xsRGF0YSA9IGdldFNjcm9sbERhdGEoY29tcG9uZW50RWwsIChjb250ZW50RWwgfHwgZm9vdGVyRWwpLCBrZXlib2FyZEhlaWdodCk7XG4gIGlmIChjb250ZW50RWwgJiYgTWF0aC5hYnMoc2Nyb2xsRGF0YS5zY3JvbGxBbW91bnQpIDwgNCkge1xuICAgIC8vIHRoZSB0ZXh0IGlucHV0IGlzIGluIGEgc2FmZSBwb3NpdGlvbiB0aGF0IGRvZXNuJ3RcbiAgICAvLyByZXF1aXJlIGl0IHRvIGJlIHNjcm9sbGVkIGludG8gdmlldywganVzdCBzZXQgZm9jdXMgbm93XG4gICAgaW5wdXRFbC5mb2N1cygpO1xuICAgIHJldHVybjtcbiAgfVxuICAvLyB0ZW1wb3JhcmlseSBtb3ZlIHRoZSBmb2N1cyB0byB0aGUgZm9jdXMgaG9sZGVyIHNvIHRoZSBicm93c2VyXG4gIC8vIGRvZXNuJ3QgZnJlYWsgb3V0IHdoaWxlIGl0J3MgdHJ5aW5nIHRvIGdldCB0aGUgaW5wdXQgaW4gcGxhY2VcbiAgLy8gYXQgdGhpcyBwb2ludCB0aGUgbmF0aXZlIHRleHQgaW5wdXQgc3RpbGwgZG9lcyBub3QgaGF2ZSBmb2N1c1xuICByZWxvY2F0ZUlucHV0KGNvbXBvbmVudEVsLCBpbnB1dEVsLCB0cnVlLCBzY3JvbGxEYXRhLmlucHV0U2FmZVksIGRpc2FibGVDbG9uZWRJbnB1dCk7XG4gIGlucHV0RWwuZm9jdXMoKTtcbiAgLyoqXG4gICAqIFJlbG9jYXRpbmcvRm9jdXNpbmcgaW5wdXQgY2F1c2VzIHRoZVxuICAgKiBjbGljayBldmVudCB0byBiZSBjYW5jZWxsZWQsIHNvXG4gICAqIG1hbnVhbGx5IGZpcmUgb25lIGhlcmUuXG4gICAqL1xuICByYWYoKCkgPT4gY29tcG9uZW50RWwuY2xpY2soKSk7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxldCBzY3JvbGxDb250ZW50VGltZW91dDtcbiAgICBjb25zdCBzY3JvbGxDb250ZW50ID0gYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gY2xlYW4gdXAgbGlzdGVuZXJzIGFuZCB0aW1lb3V0c1xuICAgICAgaWYgKHNjcm9sbENvbnRlbnRUaW1lb3V0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbENvbnRlbnRUaW1lb3V0KTtcbiAgICAgIH1cbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBkb3VibGVLZXlib2FyZEV2ZW50TGlzdGVuZXIpO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2lvbktleWJvYXJkRGlkU2hvdycsIHNjcm9sbENvbnRlbnQpO1xuICAgICAgLy8gc2Nyb2xsIHRoZSBpbnB1dCBpbnRvIHBsYWNlXG4gICAgICBpZiAoY29udGVudEVsKSB7XG4gICAgICAgIGF3YWl0IHNjcm9sbEJ5UG9pbnQoY29udGVudEVsLCAwLCBzY3JvbGxEYXRhLnNjcm9sbEFtb3VudCwgc2Nyb2xsRGF0YS5zY3JvbGxEdXJhdGlvbik7XG4gICAgICB9XG4gICAgICAvLyB0aGUgc2Nyb2xsIHZpZXcgaXMgaW4gdGhlIGNvcnJlY3QgcG9zaXRpb24gbm93XG4gICAgICAvLyBnaXZlIHRoZSBuYXRpdmUgdGV4dCBpbnB1dCBmb2N1c1xuICAgICAgcmVsb2NhdGVJbnB1dChjb21wb25lbnRFbCwgaW5wdXRFbCwgZmFsc2UsIHNjcm9sbERhdGEuaW5wdXRTYWZlWSk7XG4gICAgICAvLyBlbnN1cmUgdGhpcyBpcyB0aGUgZm9jdXNlZCBpbnB1dFxuICAgICAgaW5wdXRFbC5mb2N1cygpO1xuICAgIH07XG4gICAgY29uc3QgZG91YmxlS2V5Ym9hcmRFdmVudExpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2lvbktleWJvYXJkRGlkU2hvdycsIGRvdWJsZUtleWJvYXJkRXZlbnRMaXN0ZW5lcik7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaW9uS2V5Ym9hcmREaWRTaG93Jywgc2Nyb2xsQ29udGVudCk7XG4gICAgfTtcbiAgICBpZiAoY29udGVudEVsKSB7XG4gICAgICBjb25zdCBzY3JvbGxFbCA9IGF3YWl0IGdldFNjcm9sbEVsZW1lbnQoY29udGVudEVsKTtcbiAgICAgIC8qKlxuICAgICAgICogc2Nyb2xsRGF0YSB3aWxsIG9ubHkgY29uc2lkZXIgdGhlIGFtb3VudCB3ZSBuZWVkXG4gICAgICAgKiB0byBzY3JvbGwgaW4gb3JkZXIgdG8gcHJvcGVybHkgYnJpbmcgdGhlIGlucHV0XG4gICAgICAgKiBpbnRvIHZpZXcuIEl0IHdpbGwgbm90IGNvbnNpZGVyIHRoZSBhbW91bnRcbiAgICAgICAqIHdlIGNhbiBzY3JvbGwgaW4gdGhlIGNvbnRlbnQgZWxlbWVudC5cbiAgICAgICAqIEFzIGEgcmVzdWx0LCBzY3JvbGxEYXRhIG1heSByZXF1ZXN0IGEgZ3JlYXRlclxuICAgICAgICogc2Nyb2xsIHBvc2l0aW9uIHRoYW4gaXMgY3VycmVudGx5IGF2YWlsYWJsZVxuICAgICAgICogaW4gdGhlIERPTS4gSWYgdGhpcyBpcyB0aGUgY2FzZSwgd2UgbmVlZCB0b1xuICAgICAgICogd2FpdCBmb3IgdGhlIHdlYnZpZXcgdG8gcmVzaXplL3RoZSBrZXlib2FyZFxuICAgICAgICogdG8gc2hvdyBpbiBvcmRlciBmb3IgYWRkaXRpb25hbCBzY3JvbGxcbiAgICAgICAqIGJhbmR3aWR0aCB0byBiZWNvbWUgYXZhaWxhYmxlLlxuICAgICAgICovXG4gICAgICBjb25zdCB0b3RhbFNjcm9sbEFtb3VudCA9IHNjcm9sbEVsLnNjcm9sbEhlaWdodCAtIHNjcm9sbEVsLmNsaWVudEhlaWdodDtcbiAgICAgIGlmIChzY3JvbGxEYXRhLnNjcm9sbEFtb3VudCA+IHRvdGFsU2Nyb2xsQW1vdW50IC0gc2Nyb2xsRWwuc2Nyb2xsVG9wKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbiBpT1MgZGV2aWNlcywgdGhlIHN5c3RlbSB3aWxsIHNob3cgYSBcIlBhc3N3b3Jkc1wiIGJhciBhYm92ZSB0aGUga2V5Ym9hcmRcbiAgICAgICAgICogYWZ0ZXIgdGhlIGluaXRpYWwga2V5Ym9hcmQgaXMgc2hvd24uIFRoaXMgcHJldmVudHMgdGhlIHdlYnZpZXcgZnJvbSByZXNpemluZ1xuICAgICAgICAgKiB1bnRpbCB0aGUgXCJQYXNzd29yZHNcIiBiYXIgaXMgc2hvd24sIHNvIHdlIG5lZWQgdG8gd2FpdCBmb3IgdGhhdCB0byBoYXBwZW4gZmlyc3QuXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoaW5wdXRFbC50eXBlID09PSAncGFzc3dvcmQnKSB7XG4gICAgICAgICAgLy8gQWRkIDUwcHggdG8gYWNjb3VudCBmb3IgdGhlIFwiUGFzc3dvcmRzXCIgYmFyXG4gICAgICAgICAgc2Nyb2xsRGF0YS5zY3JvbGxBbW91bnQgKz0gNTA7XG4gICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2lvbktleWJvYXJkRGlkU2hvdycsIGRvdWJsZUtleWJvYXJkRXZlbnRMaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2lvbktleWJvYXJkRGlkU2hvdycsIHNjcm9sbENvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIHNob3VsZCBvbmx5IGZpcmUgaW4gMiBpbnN0YW5jZXM6XG4gICAgICAgICAqIDEuIFRoZSBhcHAgaXMgdmVyeSBzbG93LlxuICAgICAgICAgKiAyLiBUaGUgYXBwIGlzIHJ1bm5pbmcgaW4gYSBicm93c2VyIG9uIGFuIG9sZCBPU1xuICAgICAgICAgKiB0aGF0IGRvZXMgbm90IHN1cHBvcnQgSW9uaWMgS2V5Ym9hcmQgRXZlbnRzXG4gICAgICAgICAqL1xuICAgICAgICBzY3JvbGxDb250ZW50VGltZW91dCA9IHNldFRpbWVvdXQoc2Nyb2xsQ29udGVudCwgMTAwMCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgc2Nyb2xsQ29udGVudCgpO1xuICB9XG59O1xuY29uc3QgaGFzUG9pbnRlck1vdmVkID0gKHRocmVzaG9sZCwgc3RhcnRDb29yZCwgZW5kQ29vcmQpID0+IHtcbiAgaWYgKHN0YXJ0Q29vcmQgJiYgZW5kQ29vcmQpIHtcbiAgICBjb25zdCBkZWx0YVggPSBzdGFydENvb3JkLnggLSBlbmRDb29yZC54O1xuICAgIGNvbnN0IGRlbHRhWSA9IHN0YXJ0Q29vcmQueSAtIGVuZENvb3JkLnk7XG4gICAgY29uc3QgZGlzdGFuY2UgPSBkZWx0YVggKiBkZWx0YVggKyBkZWx0YVkgKiBkZWx0YVk7XG4gICAgcmV0dXJuIGRpc3RhbmNlID4gdGhyZXNob2xkICogdGhyZXNob2xkO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IFBBRERJTkdfVElNRVJfS0VZID0gJyRpb25QYWRkaW5nVGltZXInO1xuY29uc3QgZW5hYmxlU2Nyb2xsUGFkZGluZyA9IChrZXlib2FyZEhlaWdodCkgPT4ge1xuICBjb25zdCBkb2MgPSBkb2N1bWVudDtcbiAgY29uc3Qgb25Gb2N1c2luID0gKGV2KSA9PiB7XG4gICAgc2V0U2Nyb2xsUGFkZGluZyhldi50YXJnZXQsIGtleWJvYXJkSGVpZ2h0KTtcbiAgfTtcbiAgY29uc3Qgb25Gb2N1c291dCA9IChldikgPT4ge1xuICAgIHNldFNjcm9sbFBhZGRpbmcoZXYudGFyZ2V0LCAwKTtcbiAgfTtcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvbkZvY3VzaW4pO1xuICBkb2MuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBvbkZvY3Vzb3V0KTtcbiAgcmV0dXJuICgpID0+IHtcbiAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIG9uRm9jdXNpbik7XG4gICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0Jywgb25Gb2N1c291dCk7XG4gIH07XG59O1xuY29uc3Qgc2V0U2Nyb2xsUGFkZGluZyA9IChpbnB1dCwga2V5Ym9hcmRIZWlnaHQpID0+IHtcbiAgdmFyIF9hLCBfYjtcbiAgaWYgKGlucHV0LnRhZ05hbWUgIT09ICdJTlBVVCcpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGlucHV0LnBhcmVudEVsZW1lbnQgJiYgaW5wdXQucGFyZW50RWxlbWVudC50YWdOYW1lID09PSAnSU9OLUlOUFVUJykge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoKChfYiA9IChfYSA9IGlucHV0LnBhcmVudEVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXJlbnRFbGVtZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudGFnTmFtZSkgPT09ICdJT04tU0VBUkNIQkFSJykge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBlbCA9IGZpbmRDbG9zZXN0SW9uQ29udGVudChpbnB1dCk7XG4gIGlmIChlbCA9PT0gbnVsbCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB0aW1lciA9IGVsW1BBRERJTkdfVElNRVJfS0VZXTtcbiAgaWYgKHRpbWVyKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgfVxuICBpZiAoa2V5Ym9hcmRIZWlnaHQgPiAwKSB7XG4gICAgZWwuc3R5bGUuc2V0UHJvcGVydHkoJy0ta2V5Ym9hcmQtb2Zmc2V0JywgYCR7a2V5Ym9hcmRIZWlnaHR9cHhgKTtcbiAgfVxuICBlbHNlIHtcbiAgICBlbFtQQURESU5HX1RJTUVSX0tFWV0gPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGVsLnN0eWxlLnNldFByb3BlcnR5KCctLWtleWJvYXJkLW9mZnNldCcsICcwcHgnKTtcbiAgICB9LCAxMjApO1xuICB9XG59O1xuXG5jb25zdCBJTlBVVF9CTFVSUklORyA9IHRydWU7XG5jb25zdCBTQ1JPTExfUEFERElORyA9IHRydWU7XG5jb25zdCBzdGFydElucHV0U2hpbXMgPSAoY29uZmlnLCBwbGF0Zm9ybSkgPT4ge1xuICBjb25zdCBkb2MgPSBkb2N1bWVudDtcbiAgY29uc3QgaXNJT1MgPSBwbGF0Zm9ybSA9PT0gJ2lvcyc7XG4gIGNvbnN0IGlzQW5kcm9pZCA9IHBsYXRmb3JtID09PSAnYW5kcm9pZCc7XG4gIC8qKlxuICAgKiBIaWRlIENhcmV0IGFuZCBJbnB1dCBCbHVycmluZyBhcmUgbmVlZGVkIG9uIGlPUy5cbiAgICogU2Nyb2xsIEFzc2lzdCBhbmQgU2Nyb2xsIFBhZGRpbmcgYXJlIG5lZWRlZCBvbiBpT1MgYW5kIEFuZHJvaWRcbiAgICogd2l0aCBDaHJvbWUgd2ViIGJyb3dzZXIgKG5vdCBDaHJvbWUgd2VidmlldykuXG4gICAqL1xuICBjb25zdCBrZXlib2FyZEhlaWdodCA9IGNvbmZpZy5nZXROdW1iZXIoJ2tleWJvYXJkSGVpZ2h0JywgMjkwKTtcbiAgY29uc3Qgc2Nyb2xsQXNzaXN0ID0gY29uZmlnLmdldEJvb2xlYW4oJ3Njcm9sbEFzc2lzdCcsIHRydWUpO1xuICBjb25zdCBoaWRlQ2FyZXQgPSBjb25maWcuZ2V0Qm9vbGVhbignaGlkZUNhcmV0T25TY3JvbGwnLCBpc0lPUyk7XG4gIGNvbnN0IGlucHV0Qmx1cnJpbmcgPSBjb25maWcuZ2V0Qm9vbGVhbignaW5wdXRCbHVycmluZycsIGlzSU9TKTtcbiAgY29uc3Qgc2Nyb2xsUGFkZGluZyA9IGNvbmZpZy5nZXRCb29sZWFuKCdzY3JvbGxQYWRkaW5nJywgdHJ1ZSk7XG4gIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oZG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lvbi1pbnB1dCwgaW9uLXRleHRhcmVhJykpO1xuICBjb25zdCBoaWRlQ2FyZXRNYXAgPSBuZXcgV2Vha01hcCgpO1xuICBjb25zdCBzY3JvbGxBc3Npc3RNYXAgPSBuZXcgV2Vha01hcCgpO1xuICBjb25zdCByZWdpc3RlcklucHV0ID0gYXN5bmMgKGNvbXBvbmVudEVsKSA9PiB7XG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IGNvbXBvbmVudE9uUmVhZHkoY29tcG9uZW50RWwsIHJlc29sdmUpKTtcbiAgICBjb25zdCBpbnB1dFJvb3QgPSBjb21wb25lbnRFbC5zaGFkb3dSb290IHx8IGNvbXBvbmVudEVsO1xuICAgIGNvbnN0IGlucHV0RWwgPSBpbnB1dFJvb3QucXVlcnlTZWxlY3RvcignaW5wdXQnKSB8fCBpbnB1dFJvb3QucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKTtcbiAgICBjb25zdCBzY3JvbGxFbCA9IGZpbmRDbG9zZXN0SW9uQ29udGVudChjb21wb25lbnRFbCk7XG4gICAgY29uc3QgZm9vdGVyRWwgPSAhc2Nyb2xsRWwgPyBjb21wb25lbnRFbC5jbG9zZXN0KCdpb24tZm9vdGVyJykgOiBudWxsO1xuICAgIGlmICghaW5wdXRFbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoISFzY3JvbGxFbCAmJiBoaWRlQ2FyZXQgJiYgIWhpZGVDYXJldE1hcC5oYXMoY29tcG9uZW50RWwpKSB7XG4gICAgICBjb25zdCBybUZuID0gZW5hYmxlSGlkZUNhcmV0T25TY3JvbGwoY29tcG9uZW50RWwsIGlucHV0RWwsIHNjcm9sbEVsKTtcbiAgICAgIGhpZGVDYXJldE1hcC5zZXQoY29tcG9uZW50RWwsIHJtRm4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBkYXRlL2RhdGV0aW1lLWxvY2FsZSBpbnB1dHMgb24gbW9iaWxlIGRldmljZXMgc2hvdyBkYXRlIHBpY2tlclxuICAgICAqIG92ZXJsYXlzIGluc3RlYWQgb2Yga2V5Ym9hcmRzLiBBcyBhIHJlc3VsdCwgc2Nyb2xsIGFzc2lzdCBpc1xuICAgICAqIG5vdCBuZWVkZWQuIFRoaXMgYWxzbyB3b3JrcyBhcm91bmQgYSBidWcgaW4gaU9TIDwxNiB3aGVyZVxuICAgICAqIHNjcm9sbCBhc3Npc3QgY2F1c2VzIHRoZSBicm93c2VyIHRvIGxvY2sgdXAuIFNlZSBGVy0xOTk3LlxuICAgICAqL1xuICAgIGNvbnN0IGlzRGF0ZUlucHV0ID0gaW5wdXRFbC50eXBlID09PSAnZGF0ZScgfHwgaW5wdXRFbC50eXBlID09PSAnZGF0ZXRpbWUtbG9jYWwnO1xuICAgIGlmICghaXNEYXRlSW5wdXQgJiZcbiAgICAgICghIXNjcm9sbEVsIHx8ICEhZm9vdGVyRWwpICYmXG4gICAgICBzY3JvbGxBc3Npc3QgJiZcbiAgICAgICFzY3JvbGxBc3Npc3RNYXAuaGFzKGNvbXBvbmVudEVsKSkge1xuICAgICAgY29uc3Qgcm1GbiA9IGVuYWJsZVNjcm9sbEFzc2lzdChjb21wb25lbnRFbCwgaW5wdXRFbCwgc2Nyb2xsRWwsIGZvb3RlckVsLCBrZXlib2FyZEhlaWdodCwgaXNBbmRyb2lkKTtcbiAgICAgIHNjcm9sbEFzc2lzdE1hcC5zZXQoY29tcG9uZW50RWwsIHJtRm4pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgdW5yZWdpc3RlcklucHV0ID0gKGNvbXBvbmVudEVsKSA9PiB7XG4gICAgaWYgKGhpZGVDYXJldCkge1xuICAgICAgY29uc3QgZm4gPSBoaWRlQ2FyZXRNYXAuZ2V0KGNvbXBvbmVudEVsKTtcbiAgICAgIGlmIChmbikge1xuICAgICAgICBmbigpO1xuICAgICAgfVxuICAgICAgaGlkZUNhcmV0TWFwLmRlbGV0ZShjb21wb25lbnRFbCk7XG4gICAgfVxuICAgIGlmIChzY3JvbGxBc3Npc3QpIHtcbiAgICAgIGNvbnN0IGZuID0gc2Nyb2xsQXNzaXN0TWFwLmdldChjb21wb25lbnRFbCk7XG4gICAgICBpZiAoZm4pIHtcbiAgICAgICAgZm4oKTtcbiAgICAgIH1cbiAgICAgIHNjcm9sbEFzc2lzdE1hcC5kZWxldGUoY29tcG9uZW50RWwpO1xuICAgIH1cbiAgfTtcbiAgaWYgKGlucHV0Qmx1cnJpbmcgJiYgSU5QVVRfQkxVUlJJTkcpIHtcbiAgICBlbmFibGVJbnB1dEJsdXJyaW5nKCk7XG4gIH1cbiAgaWYgKHNjcm9sbFBhZGRpbmcgJiYgU0NST0xMX1BBRERJTkcpIHtcbiAgICBlbmFibGVTY3JvbGxQYWRkaW5nKGtleWJvYXJkSGVpZ2h0KTtcbiAgfVxuICAvLyBJbnB1dCBtaWdodCBiZSBhbHJlYWR5IGxvYWRlZCBpbiB0aGUgRE9NIGJlZm9yZSBpb24tZGV2aWNlLWhhY2tzIGRpZC5cbiAgLy8gQXQgdGhpcyBwb2ludCB3ZSBuZWVkIHRvIGxvb2sgZm9yIGFsbCBvZiB0aGUgaW5wdXRzIG5vdCByZWdpc3RlcmVkIHlldFxuICAvLyBhbmQgcmVnaXN0ZXIgdGhlbS5cbiAgZm9yIChjb25zdCBpbnB1dCBvZiBpbnB1dHMpIHtcbiAgICByZWdpc3RlcklucHV0KGlucHV0KTtcbiAgfVxuICBkb2MuYWRkRXZlbnRMaXN0ZW5lcignaW9uSW5wdXREaWRMb2FkJywgKChldikgPT4ge1xuICAgIHJlZ2lzdGVySW5wdXQoZXYuZGV0YWlsKTtcbiAgfSkpO1xuICBkb2MuYWRkRXZlbnRMaXN0ZW5lcignaW9uSW5wdXREaWRVbmxvYWQnLCAoKGV2KSA9PiB7XG4gICAgdW5yZWdpc3RlcklucHV0KGV2LmRldGFpbCk7XG4gIH0pKTtcbn07XG5cbmV4cG9ydCB7IHN0YXJ0SW5wdXRTaGltcyB9O1xuIl0sIm5hbWVzIjpbImNsb25lTWFwIiwiV2Vha01hcCIsInJlbG9jYXRlSW5wdXQiLCJjb21wb25lbnRFbCIsImlucHV0RWwiLCJzaG91bGRSZWxvY2F0ZSIsImlucHV0UmVsYXRpdmVZIiwiZGlzYWJsZWRDbG9uZWRJbnB1dCIsImhhcyIsImFkZENsb25lIiwicmVtb3ZlQ2xvbmUiLCJpc0ZvY3VzZWQiLCJpbnB1dCIsImdldFJvb3ROb2RlIiwiYWN0aXZlRWxlbWVudCIsInBhcmVudEVsIiwicGFyZW50Tm9kZSIsImNsb25lZEVsIiwiY2xvbmVOb2RlIiwiY2xhc3NMaXN0IiwiYWRkIiwidGFiSW5kZXgiLCJkaXNhYmxlZCIsImFwcGVuZENoaWxkIiwic2V0IiwiZG9jIiwib3duZXJEb2N1bWVudCIsInR4IiwiZGlyIiwic3R5bGUiLCJwb2ludGVyRXZlbnRzIiwidHJhbnNmb3JtIiwiY2xvbmUiLCJnZXQiLCJkZWxldGUiLCJyZW1vdmUiLCJlbmFibGVIaWRlQ2FyZXRPblNjcm9sbCIsInNjcm9sbEVsIiwic2Nyb2xsSGlkZUNhcmV0Iiwic2hvdWxkSGlkZUNhcmV0Iiwib25CbHVyIiwiaGlkZUNhcmV0Iiwic2hvd0NhcmV0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJTS0lQX1NFTEVDVE9SIiwiZ2V0U2Nyb2xsRGF0YSIsImNvbnRlbnRFbCIsImtleWJvYXJkSGVpZ2h0IiwiX2EiLCJpdGVtRWwiLCJjbG9zZXN0IiwiY2FsY1Njcm9sbERhdGEiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJkZWZhdWx0VmlldyIsImlubmVySGVpZ2h0IiwiaW5wdXRSZWN0IiwiY29udGVudFJlY3QiLCJwbGF0Zm9ybUhlaWdodCIsImlucHV0VG9wIiwidG9wIiwiaW5wdXRCb3R0b20iLCJib3R0b20iLCJ2aXNpYmxlQXJlYVRvcCIsInNhZmVBcmVhVG9wIiwiZGlzdGFuY2VUb0JvdHRvbSIsIk1hdGgiLCJtaW4iLCJkaXN0YW5jZVRvVG9wIiwiZGVzaXJlZFNjcm9sbEFtb3VudCIsInJvdW5kIiwic2Nyb2xsQW1vdW50IiwiZHVyYXRpb24iLCJhYnMiLCJzY3JvbGxEdXJhdGlvbiIsIm1heCIsInNjcm9sbFBhZGRpbmciLCJpbnB1dFNhZmVZIiwiZW5hYmxlU2Nyb2xsQXNzaXN0IiwiZm9vdGVyRWwiLCJjb29yZCIsImRpc2FibGVDbG9uZWRJbnB1dCIsInRvdWNoU3RhcnQiLCJldiIsInBvaW50ZXJDb29yZCIsInRvdWNoRW5kIiwiZW5kQ29vcmQiLCJoYXNQb2ludGVyTW92ZWQiLCJqc1NldEZvY3VzIiwiY2FwdHVyZSIsInBhc3NpdmUiLCJzY3JvbGxEYXRhIiwiZm9jdXMiLCJyYWYiLCJjbGljayIsIndpbmRvdyIsInNjcm9sbENvbnRlbnQiLCJ1bmRlZmluZWQiLCJzY3JvbGxDb250ZW50VGltZW91dCIsImNsZWFyVGltZW91dCIsImRvdWJsZUtleWJvYXJkRXZlbnRMaXN0ZW5lciIsInNjcm9sbEJ5UG9pbnQiLCJnZXRTY3JvbGxFbGVtZW50IiwidG90YWxTY3JvbGxBbW91bnQiLCJzY3JvbGxIZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJzY3JvbGxUb3AiLCJ0eXBlIiwic2V0VGltZW91dCIsInRocmVzaG9sZCIsInN0YXJ0Q29vcmQiLCJkZWx0YVgiLCJ4IiwiZGVsdGFZIiwieSIsIlBBRERJTkdfVElNRVJfS0VZIiwic2V0U2Nyb2xsUGFkZGluZyIsIl9iIiwidGFnTmFtZSIsInBhcmVudEVsZW1lbnQiLCJlbCIsImZpbmRDbG9zZXN0SW9uQ29udGVudCIsInRpbWVyIiwic2V0UHJvcGVydHkiLCJzdGFydElucHV0U2hpbXMiLCJjb25maWciLCJwbGF0Zm9ybSIsImRvY3VtZW50IiwiaXNJT1MiLCJpc0FuZHJvaWQiLCJnZXROdW1iZXIiLCJzY3JvbGxBc3Npc3QiLCJnZXRCb29sZWFuIiwiaW5wdXRCbHVycmluZyIsImlucHV0cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJoaWRlQ2FyZXRNYXAiLCJzY3JvbGxBc3Npc3RNYXAiLCJyZWdpc3RlcklucHV0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb21wb25lbnRPblJlYWR5IiwiaW5wdXRSb290Iiwic2hhZG93Um9vdCIsInF1ZXJ5U2VsZWN0b3IiLCJybUZuIiwiZm9jdXNlZCIsImRpZFNjcm9sbCIsIm9uU2Nyb2xsIiwib25Gb2N1c2luIiwib25Ub3VjaGVuZCIsImFjdGl2ZSIsIm1hdGNoZXMiLCJ0YXBwZWQiLCJ0YXJnZXQiLCJibHVyIiwiZW5hYmxlSW5wdXRCbHVycmluZyIsIm9uRm9jdXNvdXQiLCJlbmFibGVTY3JvbGxQYWRkaW5nIiwiZGV0YWlsIiwiZm4iLCJ1bnJlZ2lzdGVySW5wdXQiXSwic291cmNlUm9vdCI6IiJ9